<div class="post-card" data-post-id="<%= post._id %>">
    <div class="post-header">
        <strong><%= post.author.fullName %></strong>
        <% if (post.groupId) { %>
            <span class="post-group-ref">from <%= post.groupId.name %></span>
        <% } %>
        <span class="post-date"><%= post.createdAt.toLocaleString() %></span>
    </div>

    <div class="post-content">
        <p><%= post.content %></p>
        <% if (post.imageUrl) { %>
            <img src="<%= post.imageUrl %>" class="post-image" />
        <% } %>
    </div>

    <div class="post-actions">
        <button class="like-btn glass-button">
            <span class="like-count"><%= post.likes.length %></span>
            &nbsp;<%= post.likes.length === 1 ? 'like' : 'likes' %>
        </button>
        <button class="comment-toggle-btn glass-button">
            <span class="comment-count"><%= post.comments.length %></span>
            &nbsp;<%= post.comments.length === 1 ? 'comment' : 'comments' %>
        </button>
        <% if (post.author._id.toString() === user._id.toString()) { %>
            <button class="delete-post-btn glass-button">üóëÔ∏è</button>
        <% } %>
    </div>

    <div class="post-comments" style="display: none;">
        <form class="comment-form">
            <input type="text" name="comment" class="comment-input" placeholder="write your comment here" required />
            <button type="submit" class="comment-submit-btn glass-button">Send</button>
        </form>

        <ul class="comment-list">
            <% post.comments.forEach(comment => { %>
                <li class="comment-item">
                    <% if (comment.userId && comment.userId.fullName) { %>
                        <strong><%= comment.userId.fullName %>:</strong> <%= comment.content %>
                        <% if (comment.userId._id.toString() === user._id.toString()) { %>
                            <button class="delete-comment-btn glass-button" data-created-at="<%= comment.createdAt.toISOString() %>">delete</button>
                        <% } %>
                    <% } else { %>
                        <strong>Unknown:</strong> <%= comment.content %>
                    <% } %>
                </li>
            <% }) %>
        </ul>
    </div>
</div>
